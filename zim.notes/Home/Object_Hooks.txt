Content-Type: text/x-zim-wiki
Wiki-Format: zim 0.4
Creation-Date: 2011-01-27T18:28:24.745967

====== Object Hooks ======
To see validation hooks, see [[Home:Rails Methods|Rails Methods]]

Defined in Model.
//Example defined in User Model (depot2)://

after_destroy __:after_user_destroy__

//and then make sure the method is defined in the same Model as the after_destroy method.//

  def after_user_destroy 										#make sure there's always a user after the first user is created
    if User.count.zero?

     ** raise** "Can't delete last user"								<<- exceptions appear in the flash notice (raise raises an exception)
    end
  end

//Now, since after_destroy works on the delete request, and the delete request is handled by the destroy action (default), the destroy action has to rescue the exception in the UsersController://

  def destroy
    @user = User.find(params[:id])
    **begin**
      flash[:notice] = "User #{@user.name} was successfully deleted"
      @user.destroy
    **rescue** Exception => e
      flash[:notice] = e.__message__
    **end																	**<<-if it handles the exception, the rest of the method is still invoked and they go to index
    respond_to do |format|
      format.html { redirect_to(:action => :index) }
      format.xml  { head :ok }
    end
  end

→ __before_destroy__



→ __before_save__
//Example in Twitter-Like://

